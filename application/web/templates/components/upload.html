<!-- ä¸Šä¼ æ–‡ä»¶åŒºåŸŸ -->
<div class="row mb-4">
  <div class="col-md-8">
    <div class="upload-controls-row">
      <!-- æ‹–æ‹½ä¸Šä¼ åŒºåŸŸ -->
      <div class="drag-drop-container">
        <div class="upload-section-title">ä¸Šä¼ æ–‡ä»¶</div>
        <div id="dragDropArea" class="drag-drop-area" title="æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œï¼Œæˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶">
          <div class="drag-icon">ğŸ“</div>
          <div class="drag-text">æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ</div>
          <div class="drag-hint">æ”¯æŒ .txt, .csv æ–‡ä»¶</div>
          <div class="drag-hint">æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</div>
        </div>
        
        <!-- å·²é€‰æ‹©çš„æ–‡ä»¶åˆ—è¡¨ -->
        <div id="selectedFilesList" class="selected-files-list" style="display: none;">
          <div id="selectedFilesContent"></div>
        </div>
      </div>
      
      <!-- æ–‡ä»¶ç»Ÿè®¡ä¸æ‰§è¡Œæ‹ŸåˆæŒ‰é’®è¡Œ -->
      <div class="upload-action-container mt-3">
        <div class="row align-items-center g-2">
          <!-- æ–‡ä»¶ç»Ÿè®¡ä¿¡æ¯ -->
          <div class="col-md-4">
            <div class="upload-info">
              <div id="fileCountInfo" class="file-count">
                å…±ä¸Šä¼  <span id="uploadedFileCount">0</span> ä¸ªæ–‡ä»¶ï¼Œ
                å·²æ‹Ÿåˆ <span id="processedFileCount">0</span> ä¸ªæ–‡ä»¶
              </div>
            </div>
          </div>
          <!-- æ‰§è¡Œæ‹ŸåˆæŒ‰é’® -->
          <div class="col-md-4 text-center">
            <button id="btnProcess" class="btn btn-process" type="button" title="æ‰§è¡Œæ‹Ÿåˆå¤„ç†" disabled>
              æ‰§è¡Œæ‹Ÿåˆ
            </button>
          </div>
          <!-- ä¸‹è½½æ‰€æœ‰å›¾ç‰‡æŒ‰é’® -->
          <div class="col-md-4 text-end">
            <button id="btnDownloadAll" class="btn btn-download" type="button" title="ä¸‹è½½å½“å‰æ•°æ®é›†çš„æ‰€æœ‰å›¾ç‰‡" disabled>
              ä¸‹è½½æ‰€æœ‰å›¾ç‰‡
            </button>
          </div>
        </div>
      </div>
      
      <!-- åç«¯ä¿¡æ¯æç¤ºæ  -->
      <div id="backendMessageContainer" class="backend-message-container mt-3" style="display: none;">
        <div class="backend-message alert" role="alert">
          <div class="d-flex align-items-center">
            <div class="me-2">â„¹ï¸</div>
            <div id="backendMessageText" class="flex-grow-1"></div>
            <button type="button" class="btn-close" onclick="hideBackendMessage()"></button>
          </div>
        </div>
      </div>
      
      <!-- å¤„ç†ç»“æœæ¶ˆæ¯ -->
      <div class="process-result-container mt-3">
        <div id="processResult"></div>
      </div>
      
      <!-- éšè—çš„æ–‡ä»¶è¾“å…¥ï¼Œç”¨äºç‚¹å‡»æ‹–æ‹½åŒºåŸŸæ—¶è§¦å‘ -->
      <input type="file" name="datafiles" id="datafiles" multiple class="d-none" accept=".txt,.csv">
    </div>
  </div>
</div>

<style>
  .drag-drop-area {
    border: 2px dashed #6c757d;
    border-radius: 8px;
    padding: 30px 20px;
    text-align: center;
    background-color: #f8f9fa;
    transition: all 0.3s ease;
    cursor: pointer;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  
  .drag-drop-area:hover {
    border-color: #4361ee;
    background-color: #e9ecef;
  }
  
  .drag-drop-area.drag-over {
    border-color: #4361ee;
    background-color: #e7f3ff;
  }
  
  .drag-icon {
    font-size: 3rem;
    color: #6c757d;
    margin-bottom: 15px;
  }
  
  .drag-text {
    font-size: 1rem;
    color: #495057;
    margin-bottom: 5px;
  }
  
  .drag-hint {
    font-size: 0.85rem;
    color: #6c757d;
  }
  
  .selected-files-list {
    max-height: 150px;
    overflow-y: auto;
    margin-top: 10px;
    padding: 10px;
    background: white;
    border-radius: 6px;
    border: 1px solid #dee2e6;
  }
  
  .selected-file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px 8px;
    margin-bottom: 5px;
    background: #f8f9fa;
    border-radius: 4px;
    font-size: 0.9rem;
  }
  
  .selected-file-name {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  
  .remove-file-btn {
    background: none;
    border: none;
    color: #dc3545;
    cursor: pointer;
    font-size: 1.2rem;
    padding: 0 5px;
  }
  
  .upload-info {
    padding: 8px 12px;
    background-color: #f8f9fa;
    border-radius: 6px;
    border: 1px solid #dee2e6;
  }
  
  .file-count {
    font-size: 0.9rem;
    color: #495057;
  }
  
  /* æ‰§è¡Œæ‹ŸåˆæŒ‰é’®æ ·å¼ */
  .btn-process {
    padding: 8px 24px;
    font-weight: 500;
    transition: all 0.2s ease;
    min-width: 120px;
  }
  
  .btn-process:not(:disabled) {
    background-color: #198754; /* Bootstrap success green */
    border-color: #198754;
    color: white;
  }
  
  .btn-process:not(:disabled):hover {
    background-color: #157347;
    border-color: #146c43;
    transform: translateY(-1px);
  }
  
  .btn-process:disabled {
    background-color: #6c757d; /* Bootstrap secondary gray */
    border-color: #6c757d;
    cursor: not-allowed;
    opacity: 0.65;
  }
  
  /* ä¸‹è½½æŒ‰é’®æ ·å¼ */
  .btn-download {
    padding: 8px 24px;
    font-weight: 500;
    transition: all 0.2s ease;
    min-width: 140px;
    background-color: #0d6efd; /* Bootstrap primary blue */
    border-color: #0d6efd;
    color: white;
  }
  
  .btn-download:hover:not(:disabled) {
    background-color: #0b5ed7;
    border-color: #0a58ca;
    transform: translateY(-1px);
  }
  
  .btn-download:disabled {
    background-color: #6c757d;
    border-color: #6c757d;
    cursor: not-allowed;
    opacity: 0.65;
  }
  
  /* åç«¯ä¿¡æ¯æç¤ºæ æ ·å¼ */
  .backend-message-container {
    animation: fadeIn 0.3s ease;
  }
  
  .backend-message {
    padding: 12px 16px;
    border-radius: 8px;
    border-left: 4px solid #0dcaf0; /* Bootstrap info color */
    background-color: #d1ecf1;
    border-color: #bee5eb;
    color: #0c5460;
  }
  
  .backend-message .btn-close {
    padding: 0.75rem;
  }
  
  /* è¿›åº¦æ¡åŠ¨ç”» */
  .progress-bar-animated {
    animation: progress-bar-stripes 1s linear infinite;
  }
  
  @keyframes progress-bar-stripes {
    from { background-position: 1rem 0; }
    to { background-position: 0 0; }
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-5px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  /* æ–‡æœ¬æˆªæ–­ */
  .text-truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 150px;
    display: inline-block;
    vertical-align: bottom;
  }
</style>